<!DOCTYPE html>
<html lang="en" xmlns:th="http://www.thymeleaf.org" xmlns:layout="http://www.ultraq.net.nz/thymeleaf/layout"
     layout:decorate="~{mainlayout.html}">

<head>
     <meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
     <title>GesamtStat Page</title>

     <meta name="keywords" content="Home" />
     <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no" />

     <!-- Bootstrap CSS -->
     <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@4.5.3/dist/css/bootstrap.min.css"
          integrity="sha384-TX8t27EcRE3e/ihU7zmQxVncDAy5uIKz4rEkgIXeMed4M0jlfIDPvg6uqKI2xXr2" crossorigin="anonymous">
     <link rel="stylesheet" href="../static/css/sb-admin-2.css" th:href="@{/css/sb-admin-2.css}">


    <!-- jQuery and JS bundle w/ Popper.js -->
     <script src="https://code.jquery.com/jquery-3.5.1.slim.min.js"
          integrity="sha384-DfXdz2htPH0lsSSs5nCTpuj/zy4C+OGpamoFVy38MVBnE+IbbVYUew+OrCXaRkfj"
          crossorigin="anonymous"></script>
     <script src="https://cdn.jsdelivr.net/npm/bootstrap@4.5.3/dist/js/bootstrap.bundle.min.js"
          integrity="sha384-ho+j7jyWK8fNQe+A12Hb8AhRq26LrZ/JpcUGGOn+Y7RsweNrtN/tE3MoK7ZeZDyx"
          crossorigin="anonymous"></script>

     <!-- GooglCharts Query API and JS bundle w/ Popper.js -->
     <script type="text/javascript" src="https://www.gstatic.com/charts/loader.js"></script>

     <script th:inline="javascript">

          // Load the Visualization API and the corechart package.
          google.charts.load('current', { 'packages': ['corechart'] });

          // Set a callback to run when the Google Visualization API is loaded.
          google.charts.setOnLoadCallback(drawNeueFaelleGesamtStatFromObject);
          google.charts.setOnLoadCallback(drawVisualization)

          function drawNeueFaelleGesamtStatFromObject() {

               const rest_data = /*[[${gesamtStatList}]]*/'noValue';

               let neueFaelleGesamtChartData = new google.visualization.DataTable();
               neueFaelleGesamtChartData.addColumn('string', 'Datum');
               neueFaelleGesamtChartData.addColumn('number', 'Anzahl');

               rest_data.forEach(function (data) {
                    const datum = data.datum;
                    const neueFaelle = data.anzahlNeueFaelle;
                    neueFaelleGesamtChartData.addRow([datum, neueFaelle]);
               });

               const options = {
                    title: 'Neue KrankheitsFälle From Object',
                    legend: {position: 'top',},
                    width: '100%',
                    height: 350,
                    chartArea: {
                         height: '100%',
                         width: '100%',
                         top: 64,
                         left: 72,
                         bottom: 72,
                         right: 32,
                    },
                    vAxis: { title: 'Neue Fälle' },
                    hAxis: {
                         textPosition: 'out',
                         slantedText: true,
                         slantedTextAngle: 90,
                         textStyle: {
                              fontSize: 10,
                         },
                    }
               };

               let neueFaelleGesamtChart =
                    new google.visualization.ColumnChart(document.getElementById('neueFaelleGesamtChartFromObject_div'));

               neueFaelleGesamtChart.draw(neueFaelleGesamtChartData, options);
          }



          function drawVisualization() {

               const rest_data = /*[[${gesamtStatList}]]*/'noValue';

               let neueFaelleGesamtChartData = new google.visualization.DataTable();
               neueFaelleGesamtChartData.addColumn('string', 'Datum');
               neueFaelleGesamtChartData.addColumn('number', 'Anzahl');
               neueFaelleGesamtChartData.addColumn('number', '7-Tages-Durchschnitt');

               rest_data.forEach(function (data) {
                    const datum = data.datum;
                    const neueFaelle = data.anzahlNeueFaelle;
                    const tagesInz = data.anzahlFaelle7Tage / 7
                    neueFaelleGesamtChartData.addRow([datum, neueFaelle, tagesInz]);
               });

               const options = {
                    title: 'Monthly Coffee Production by ',
                    seriesType: 'bars',
                    series: { 1: { type: 'line' } },
                    legend: {position: 'top',},
                    width: '100%',
                    height: 350,
                    chartArea: {
                         height: '100%',
                         width: '100%',
                         top: 64,
                         left: 72,
                         bottom: 72,
                         right: 32,
                    },
                    vAxis: { title: 'Neue Fälle' },
                    hAxis: {
                         textPosition: 'out',
                         slantedText: true,
                         slantedTextAngle: 90,
                         textStyle: {
                              fontSize: 10,
                         },
                    }
               };

               let chart = new google.visualization.ComboChart(document.getElementById('chart_div'));
               chart.draw(neueFaelleGesamtChartData, options);
          }





     </script>
</head>

<body class="bg-gray-900">
     <main>
          <div class="container-fluid" layout:fragment="content">
              <nav class="navbar navbar-dark topbar mb-4 static-top">
                  <h3 class="text-light pt-3 pl-3">Dashboard - Allgemeine Daten</h3>
                  <form method="POST" th:action="@{/covid/index/}" th:object="${bundesland}"
                        class="d-none d-sm-inline-block form-inline mr-auto ml-md-3 my-2 my-md-0 mw-100 navbar-search">
                      <div class="input-group">
                          <select id="name" class="custom-select" th:field="*{name}">
                              <option th:each="bundeslands : ${bundeslandList}"
                                      th:value="${bundeslands.getName()}"
                                      th:text="${bundeslands.getName()}">
                          </select>
                          <div class="input-group-append">
                              <button class="btn btn-secondary" type="submit">Auswählen</button>
                          </div>
                      </div>
                  </form>
              </nav>

             <!-- Neue Fälle -->
              <div class="row justify-content-center">
                  <div class="col-2 my-3 py-4 px-3 bg-gray-800">
                      <div class="col pb-3">
                          <div class="card border-left-primary shadow py-2">
                              <div class="card-body">
                                  <div class="row no-gutters align-items-center">
                                      <div class="col mr-2">
                                          <div class="h2 font-weight-bold text-primary text-uppercase mb-1">
                                              Neue Fälle:</div>
                                          <span class="h3 mb-0 font-weight-bold text-gray-800"
                                                th:text="${latestGesamtStat.getAnzahlNeueFaelle()}" >666</span>
                                          <span class="h5 mb-0 ml-2 font-weight-bold"
                                                th:classappend="${latestGesamtStat.getDiffNeueFaelle() >= 0 ? 'text-success' : 'text-danger'}"
                                                th:text="'(' + ${latestGesamtStat.getDiffNeueFaelle() >= 0 ? '+' : ''} + ${latestGesamtStat.getDiffNeueFaelle()} + ')' ">123</span>
                                      </div>
                                      <div class="col-auto">
                                          <i class="fas fa-calendar fa-2x text-gray-300"></i>
                                      </div>
                                  </div>
                              </div>
                          </div>
                      </div>

                      <!-- Neue Fälle Gesamt -->
                      <div class="col">
                          <div class="card border-left-primary shadow py-2">
                              <div class="card-body">
                                  <div class="row no-gutters align-items-center">
                                      <div class="col mr-2">
                                          <div class="h2 font-weight-bold text-primary text-uppercase mb-1">
                                              Fälle Gesamt:</div>
                                          <span class="h3 mb-0 font-weight-bold text-gray-800"
                                                th:text="${latestGesamtStat.getAnzahlFaelleGesamt()}" >666</span>
                                      </div>
                                      <div class="col-auto">
                                          <i class="fas fa-calendar fa-2x text-gray-300"></i>
                                      </div>
                                  </div>
                              </div>
                          </div>
                      </div>
                  </div>




              <!-- 7 Tages Durchschnitt -->
                  <div class="col-2 my-3 mx-4 py-4 px-3 bg-gray-800">
                      <div class="col pb-3">
                          <div class="card border-left-primary shadow py-2">
                              <div class="card-body">
                                  <div class="row no-gutters align-items-center">
                                      <div class="col mr-2">
                                          <div class="h2 font-weight-bold text-primary text-uppercase mb-1">
                                              7-Tages Ø:</div>
                                          <span class="h3 mb-0 font-weight-bold text-gray-800"
                                                th:text="${latestGesamtStat.getAnzahlFaelle7Tage()}" >666</span>
                                          <span class="h5 mb-0 ml-2 font-weight-bold"
                                                th:classappend="${latestGesamtStat.getDiffFaelle7Tage() >= 0 ? 'text-success' : 'text-danger'}"
                                                th:text="'(' + ${latestGesamtStat.getDiffFaelle7Tage() >= 0 ? '+' : ''} + ${latestGesamtStat.getDiffFaelle7Tage()} + ')' ">123</span>
                                      </div>
                                      <div class="col-auto">
                                          <i class="fas fa-calendar fa-2x text-gray-300"></i>
                                      </div>
                                  </div>
                              </div>
                          </div>
                      </div>

                      <!-- 7 Tages Inzidenz -->
                      <div class="col">
                          <div class="card border-left-primary shadow py-2">
                              <div class="card-body">
                                  <div class="row no-gutters align-items-center">
                                      <div class="col mr-2">
                                          <div class="h2 font-weight-bold text-primary text-uppercase mb-1">
                                              7-Tages Inzidenz:</div>
                                          <span class="h3 mb-0 font-weight-bold text-gray-800"
                                                th:text="${latestGesamtStat.getInzidenz7Tage()}" >666</span>
                                          <span class="h5 mb-0 ml-2 font-weight-bold"
                                                th:classappend="${latestGesamtStat.getDiffInzidenz7Tage() >= 0 ? 'text-success' : 'text-danger'}"
                                                th:text="'(' + ${latestGesamtStat.getDiffInzidenz7Tage() >= 0 ? '+' : ''} + ${latestGesamtStat.getDiffInzidenz7Tage()} + ')' ">123</span>
                                      </div>
                                      <div class="col-auto">
                                          <i class="fas fa-calendar fa-2x text-gray-300"></i>
                                      </div>
                                  </div>
                              </div>
                          </div>
                      </div>
                  </div>
              </div>



              <div class="row justify-content-center">
                  <div class="col-11 my-3 py-4 px-3 bg-gray-800">
                      <div id="neueFaelleGesamtChartFromObject_div"></div>
                  </div>
              </div>


              <div class="row justify-content-center">
                  <div class="col-11 my-3 py-4 px-3 bg-gray-800">
                      <div id="chart_div"></div>
                  </div>
              </div>
          </div>
     </main>
</body>

</html>